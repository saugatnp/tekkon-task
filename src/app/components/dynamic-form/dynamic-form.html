<form [formGroup]="form()" class="dynamic-form">

  <!-- Basic Information Section -->
  <div class="form-section">
    <h3 class="section-title">Basic Information</h3>
    <div class="section-content">
      <app-form-field
        [label]="'Project Name'"
        [control]="nameControl()"
        type="text">
      </app-form-field>

      <app-form-field
        [label]="'Description'"
        [control]="descriptionControl()"
        type="textarea"
        [placeholder]="'Describe your project...'">
      </app-form-field>
    </div>
  </div>

  <!-- Tags Section -->
  <div class="form-section">
    <div class="section-header">
      <h3 class="section-title">Tags</h3>
      <button
        mat-raised-button
        color="primary"
        type="button"
        (click)="addTag.emit()">
        <mat-icon>add</mat-icon>
        Add Tag
      </button>
    </div>
    <div class="section-content">
      <div formArrayName="tags" class="tags-list">
        @for (tagControl of tagsArray().controls; track tagControl; let i = $index) {
          <div class="tag-item">
            <app-form-field
              [label]="'Tag ' + (i + 1)"
              [control]="tagControl"
              type="text"
              [placeholder]="'Enter tag name'">
            </app-form-field>

            <button
              mat-icon-button
              color="warn"
              type="button"
              (click)="removeTag.emit(i)">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        } @empty {
          <p class="empty-message">No tags added yet. Click "Add Tag" to create one.</p>
        }
      </div>
    </div>
  </div>

  <!-- Settings Section -->
  <div class="form-section">
    <h3 class="section-title">Application Settings</h3>
    <div class="section-content">
      <app-form-field
        [label]="'Enable Notifications'"
        [control]="settingsGroup().get('notifications')!"
        type="toggle">
      </app-form-field>

      <app-form-field
        [label]="'Theme'"
        [control]="settingsGroup().get('theme')!"
        type="select"
        [options]="themeOptions()">
      </app-form-field>

      <app-form-field
        [label]="'Refresh Interval (seconds)'"
        [control]="settingsGroup().get('refreshInterval')!"
        type="number"
        [hint]="'Must be a positive number'">
      </app-form-field>
    </div>
  </div>

  <!-- Members Section -->
  <div class="form-section">
    <div class="section-header">
      <h3 class="section-title">Team Members</h3>
      <button
        mat-raised-button
        color="primary"
        type="button"
        (click)="addMember.emit()">
        <mat-icon>person_add</mat-icon>
        Add Member
      </button>
    </div>
    <div class="section-content">
      <div formArrayName="members" class="tags-list">
        @for (memberControl of membersArray().controls; track memberControl; let i = $index) {
          <div class="member-item" [formGroupName]="i">
            <div class="member-fields">
              <app-form-field
                [label]="'Member Name'"
                [control]="getMemberNameControl(memberControl)"
                type="text"
                [placeholder]="'Enter member name'">
              </app-form-field>

              <app-form-field
                [label]="'Role'"
                [control]="getMemberRoleControl(memberControl)"
                type="select"
                [options]="roleOptions()">
              </app-form-field>
              <button
                mat-icon-button
                color="warn"
                type="button"
                (click)="removeMember.emit(i)"
                class="delete-member-btn">
                <mat-icon>delete</mat-icon>
              </button>
            </div>


          </div>
        } @empty {
          <p class="empty-message">No members added yet. Click "Add Member" to create one.</p>
        }
      </div>
    </div>
  </div>

  <!-- Actions -->
  <div class="form-actions">
    <button
      mat-raised-button
      color="primary"
      type="button"
      (click)="resetForm.emit()">
      <mat-icon>refresh</mat-icon>
      Reset to Default
    </button>
  </div>
</form>
